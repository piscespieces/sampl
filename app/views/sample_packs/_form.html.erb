<%= form_with(model: sample_pack, enctype: "multipart/form-data") do |form| %>
  <% if sample_pack.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(sample_pack.errors.count, "error") %> prohibited this sample_pack from being saved:</h2>

      <ul>
        <% sample_pack.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form.hidden_field :user_id, value: current_user.id %>

  <div class="mb-6">
    <%= form.label :name, class: "block" %>
    <%= form.text_field :name, required: true, class: "text-input" %>
  </div>

  <div class="mb-6">
      <%= form.label :image, class: "block" %>
      <%= form.file_field :image %>
  </div>

  <div data-controller="audio-preview" class="mb-6">
    <%= form.fields_for :samples do |sample_form| %>
      <div class="mb-8">
        <%= sample_form.hidden_field :audio, value: sample_form.object.audio, data: { action: "change->audio-preview#getFileName" } %>
        <%= audio_tag(url_for(sample_form.object.audio), controls: "") %>
        <%= sample_form.object.tags.first&.title %>
        <%#= s.file_field :audio, { accept: "audio/wav, audio/mp3", multiple: true, include_hidden: false } %>
        <%= sample_form.check_box :_destroy %>
      </div>
    <% end %>
    <%= file_field_tag("samples[]", required: current_page?(new_sample_pack_path), multiple: true, accept: "audio/wav, audio/mp3", data: { action: "change->audio-preview#getFileName" }) %>
    <%#= form.file_field :samples_attributes, multiple: true, data: { action: "change->audio-preview#getFileName" } %>
    <div id="audio-files-container">
    </div>
  </div>

  <div>
    <%= form.submit %>
  </div>
<% end %>
